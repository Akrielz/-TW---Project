<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Accout Settings</title>
    <link rel="stylesheet" href="style.css">
</head>
<body onload="getValuesFromDatabase()">
    <div class= "settingsBackground">
    </div>
    <div class = "backgroundDim">
    </div>
    
    <nav class = "navigationMenu">
    <div>
    <ul>
        <li><a href="home.html" title="Home"> Home </a></li>
        <li><a href="linking.html" title="Linking"> Linking </a></li>
        <li><a href="history.html" title="My History"> My History </a></li>
        <li><a href="#" title="File Manager"> File Manager</a></li>
        <li><a href="#" title="Account Settings"> Account Settings</a></li>
        <li><a href="prehome.html" title="Logout"> Logout </a></li>
    </ul>
    </div>
    </nav>

    <div class = "settingsFrame">

        <div class = "settingsMenu">
            <nav class = "navigationSettings">
            <div>
            <ul>
                <li><a href="settings_1.html">
                <img src="./images/settings/personal_info2.svg" class = "ico" alt = "logo personal info">
                Personal Info 
                </a></li>

                <li><a href="settings_2.html">
                <img src="./images/settings/account_security.svg" class = "ico" alt = "logo account security"> 
                Account Security 
                </a></li>

                <li><a href="settings_3.html">
                <img src="./images/settings/clouds_settings.svg" class = "ico" alt = "logo clouds settings"> 
                Clouds Settings 
                </a></li>
                
                <li><a href="settings_4.html">
                <img src="./images/settings/advanced_settings.svg" class = "ico" alt = "logo advanced settings"> 
                Bandwidth
                </a></li>
            </ul>
            </div>
            </nav>
        </div>


        <div class = "settingsContent">
        <div class = "settingsPersonalInfo">
        
            <div class = "settingsTopSide">
                <p>Personal Info</p>
                <button class="button" onclick="applyValues()">Apply</button>
            </div>

            <div class = "settingsBotSide">
            <div class = "flexContainerSettings">
                <div> <br>
                <label for="firstName"> First name</label>
                <input type="text" id="firstName" name="firstName">
                </div>

                <div> <br>
                <label for="lastName"> Last name</label>
                <input type="text" id="lastName" name="lastName">
                </div>

                <div> <br>
                <label for="gender"> Gender </label>
                <input type="text" id="gender" name="gender">
                </div>

                <div> <br>
                <label for="country"> Country </label>
                <input type="text" id="country" name="country">
                </div>

                <div> <br>
                <label for="birthday"> Birthday</label>
                <input type="date" id="birthday" name="birthday">
                </div>
            </div>
            </div>
        </div>
        </div>

    </div>

    <script>
        async function getValuesFromDatabase()
        {
            // aici se vor seta field-urile din aceasta pagina, flower power

            let userID = localStorage.getItem("stol_owner_id");


            var url = 'http://127.0.0.1:3000/' + userID + '/user/1';
            const response = await fetch(url, {
                method: 'GET'
            });
            const myJson = await response.json();

            console.log(myJson)

            // here it must be modified to use the result json

            document.getElementById("firstName").value = myJson["personal_info"]["first_name"];
            document.getElementById("lastName").value = myJson["personal_info"]["last_name"];
            document.getElementById("gender").value = myJson["personal_info"]["gender"];
            document.getElementById("country").value = myJson["personal_info"]["country"];
            document.getElementById("birthday").value = myJson["personal_info"]["birthday"];
        }

        async function applyValues()
        {
            let firstName = document.getElementById("firstName").value;
            let lastName = document.getElementById("lastName").value;
            let gender = document.getElementById("gender").value;
            let country = document.getElementById("country").value;
            let birthday = document.getElementById("birthday").value;

            let userID = localStorage.getItem("stol_owner_id");


            var url = 'http://127.0.0.1:3000/' + userID + '/user/1';
            const response = await fetch(url, {
                method: 'PUT',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({first_name : firstName, last_name : lastName, gender : gender, country : country, birthday : birthday})
            });
            const myJson = await response.json();


        }
    </script>

</body>
</html>